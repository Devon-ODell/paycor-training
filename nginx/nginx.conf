# Basic Nginx configuration for proxying to the Go app

# Define the upstream server (our Go application container)
upstream go_app {
    # 'app' is the service name defined in docker-compose.yml
    # 8080 is the port exposed by the Go app container
    server app:8080;
}

server {
    # Listen on port 80 (standard HTTP) inside the container
    listen 80;
    server_name localhost; # Or your domain name

    # Root location - proxy all requests to the Go app
    location / {
        proxy_pass http://go_app; # Forward requests to the upstream 'go_app'

        # Set standard proxy headers
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # Optional: Increase timeouts if needed for long Paycor API calls
        # proxy_connect_timeout       600;
        # proxy_send_timeout          600;
        # proxy_read_timeout          600;
        # send_timeout                600;
    }

    # Optional: Add locations for static files if your Go app doesn't serve them
    # location /static/ {
    #     alias /path/to/static/files/in/nginx/container;
    # }

    # Optional: Access and error logs
    access_log /var/log/nginx/access.log;
    error_log /var/log/nginx/error.log;
}